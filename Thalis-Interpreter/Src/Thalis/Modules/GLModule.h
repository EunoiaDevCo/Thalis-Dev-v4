#pragma once

#include "../Value.h"
#include "../TypeInfo.h"
#include <vector>

enum class GLModuleConstant
{
    // Basic values
    TGL_ZERO,
    TGL_ONE,
    TGL_FALSE,
    TGL_TRUE,

    // Primitives / modes
    TGL_POINTS,
    TGL_LINES,
    TGL_LINE_LOOP,
    TGL_LINE_STRIP,
    TGL_TRIANGLES,
    TGL_TRIANGLE_STRIP,
    TGL_TRIANGLE_FAN,
    TGL_LINES_ADJACENCY,
    TGL_LINE_STRIP_ADJACENCY,
    TGL_TRIANGLES_ADJACENCY,
    TGL_TRIANGLE_STRIP_ADJACENCY,
    TGL_PATCHES,

    // Buffer binding targets
    TGL_ARRAY_BUFFER,
    TGL_ELEMENT_ARRAY_BUFFER,
    TGL_COPY_READ_BUFFER,
    TGL_COPY_WRITE_BUFFER,
    TGL_PIXEL_PACK_BUFFER,
    TGL_PIXEL_UNPACK_BUFFER,
    TGL_TRANSFORM_FEEDBACK_BUFFER,
    TGL_UNIFORM_BUFFER,
    TGL_SHADER_STORAGE_BUFFER,
    TGL_DISPATCH_INDIRECT_BUFFER,
    TGL_DRAW_INDIRECT_BUFFER,
    TGL_ATOMIC_COUNTER_BUFFER,
    TGL_QUERY_BUFFER,
    TGL_ACCELERATION_STRUCTURE_READ_ONLY_NV,
    TGL_ACCELERATION_STRUCTURE_WRITE_ONLY_NV,

    // Usage hints
    TGL_STATIC_DRAW,
    TGL_DYNAMIC_DRAW,
    TGL_STREAM_DRAW,
    TGL_STATIC_READ,
    TGL_DYNAMIC_READ,
    TGL_STREAM_READ,
    TGL_STATIC_COPY,
    TGL_DYNAMIC_COPY,
    TGL_STREAM_COPY,
    TGL_READ_ONLY,
    TGL_WRITE_ONLY,
    TGL_READ_WRITE,

    // Texture targets / types
    TGL_TEXTURE_1D,
    TGL_TEXTURE_2D,
    TGL_TEXTURE_3D,
    TGL_TEXTURE_1D_ARRAY,
    TGL_TEXTURE_2D_ARRAY,
    TGL_TEXTURE_RECTANGLE,
    TGL_TEXTURE_CUBE_MAP,
    TGL_TEXTURE_CUBE_MAP_ARRAY,
    TGL_TEXTURE_BUFFER,
    TGL_TEXTURE_2D_MULTISAMPLE,
    TGL_TEXTURE_2D_MULTISAMPLE_ARRAY,

    // Texture parameters / filtering / wrapping
    TGL_NEAREST,
    TGL_LINEAR,
    TGL_NEAREST_MIPMAP_NEAREST,
    TGL_LINEAR_MIPMAP_NEAREST,
    TGL_NEAREST_MIPMAP_LINEAR,
    TGL_LINEAR_MIPMAP_LINEAR,
    TGL_TEXTURE_MAG_FILTER,
    TGL_TEXTURE_MIN_FILTER,
    TGL_TEXTURE_WRAP_S,
    TGL_TEXTURE_WRAP_T,
    TGL_TEXTURE_WRAP_R,
    TGL_REPEAT,
    TGL_CLAMP_TO_EDGE,
    TGL_MIRRORED_REPEAT,
    TGL_CLAMP_TO_BORDER,

    // Internal formats, base formats
    TGL_R8,
    TGL_R16,
    TGL_RG8,
    TGL_RG16,
    TGL_R16F,
    TGL_R32F,
    TGL_RG16F,
    TGL_RG32F,
    TGL_RGBA8,
    TGL_RGBA16,
    TGL_RGBA16F,
    TGL_RGBA32F,
    TGL_SRGB8_ALPHA8,
    TGL_DEPTH_COMPONENT16,
    TGL_DEPTH_COMPONENT24,
    TGL_DEPTH_COMPONENT32F,
    TGL_DEPTH24_STENCIL8,
    TGL_DEPTH32F_STENCIL8,
    // etc.

    TGL_RGBA,

    // Pixel data types / formats
    TGL_UNSIGNED_BYTE,
    TGL_UNSIGNED_SHORT,
    TGL_UNSIGNED_INT,
    TGL_UNSIGNED_INT_24_8,
    TGL_UNSIGNED_INT_2_10_10_10_REV,
    TGL_FLOAT,
    TGL_HALF_FLOAT,
    TGL_INT,
    TGL_SHORT,
    TGL_BYTE,
    TGL_UNSIGNED_BYTE_3_3_2,
    TGL_UNSIGNED_BYTE_2_3_3_REV,
    // etc.

    TGL_CW,
    TGL_CCW,

    // Shader / program / pipeline
    TGL_VERTEX_SHADER,
    TGL_FRAGMENT_SHADER,
    TGL_GEOMETRY_SHADER,
    TGL_TESS_CONTROL_SHADER,
    TGL_TESS_EVALUATION_SHADER,
    TGL_COMPUTE_SHADER,
    TGL_PROGRAM,
    TGL_PROGRAM_PIPELINE,
    TGL_COMPILE_STATUS,
    TGL_LINK_STATUS,
    TGL_VALIDATE_STATUS,
    TGL_INFO_LOG_LENGTH,
    TGL_ATTACHED_SHADERS,
    TGL_ACTIVE_UNIFORMS,
    TGL_ACTIVE_ATTRIBUTES,
    TGL_ACTIVE_UNIFORM_BLOCKS,
    TGL_ACTIVE_UNIFORM_MAX_LENGTH,
    TGL_ACTIVE_ATTRIBUTE_MAX_LENGTH,
    TGL_ACTIVE_UNIFORM_BLOCK_MAX_NAME_LENGTH,
    // more program/shader parameters ...

    // Uniform / attribute locations & types
    TGL_INT_VEC2,
    TGL_INT_VEC3,
    TGL_INT_VEC4,
    TGL_BOOL,
    TGL_BOOL_VEC2,
    TGL_BOOL_VEC3,
    TGL_BOOL_VEC4,
    TGL_FLOAT_VEC2,
    TGL_FLOAT_VEC3,
    TGL_FLOAT_VEC4,
    TGL_FLOAT_MAT2,
    TGL_FLOAT_MAT3,
    TGL_FLOAT_MAT4,
    TGL_SAMPLER_2D,
    TGL_SAMPLER_3D,
    TGL_SAMPLER_CUBE,
    TGL_SAMPLER_2D_ARRAY,
    TGL_SAMPLER_CUBE_MAP_ARRAY,
    TGL_SAMPLER_BUFFER,
    TGL_SAMPLER_2D_MULTISAMPLE,
    TGL_SAMPLER_2D_MULTISAMPLE_ARRAY,
    TGL_SAMPLER_2D_SHADOW,
    TGL_SAMPLER_2D_ARRAY_SHADOW,
    // etc.

    // Framebuffer / renderbuffer / attachments
    TGL_FRAMEBUFFER,
    TGL_READ_FRAMEBUFFER,
    TGL_DRAW_FRAMEBUFFER,
    TGL_RENDERBUFFER,
    TGL_COLOR_ATTACHMENT0,
    TGL_COLOR_ATTACHMENT1,
    TGL_COLOR_ATTACHMENT2,
    TGL_COLOR_ATTACHMENT3,
    // up to e.g. COLOR_ATTACHMENT15 etc.
    TGL_DEPTH_ATTACHMENT,
    TGL_STENCIL_ATTACHMENT,
    TGL_DEPTH_STENCIL_ATTACHMENT,
    TGL_FRAMEBUFFER_COMPLETE,
    TGL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT,
    TGL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT,
    TGL_FRAMEBUFFER_UNSUPPORTED,
    // etc.

    // State / capability flags
    TGL_BLEND,
    TGL_DEPTH_TEST,
    TGL_CULL_FACE,
    TGL_SCISSOR_TEST,
    TGL_STENCIL_TEST,
    TGL_POLYGON_OFFSET_FILL,
    TGL_POLYGON_OFFSET_LINE,
    TGL_POLYGON_OFFSET_POINT,
    TGL_SAMPLE_ALPHA_TO_COVERAGE,
    TGL_SAMPLE_COVERAGE,
    TGL_SAMPLE_SHADING,
    TGL_MULTISAMPLE,
    TGL_SAMPLE_MASK,
    TGL_RASTERIZER_DISCARD,

    // Blend / depth / stencil / logic ops
    TGL_BLEND_SRC_RGB,
    TGL_BLEND_DST_RGB,
    TGL_BLEND_SRC_ALPHA,
    TGL_BLEND_DST_ALPHA,
    TGL_BLEND_EQUATION_RGB,
    TGL_BLEND_EQUATION_ALPHA,
    TGL_FUNC_ADD,
    TGL_FUNC_SUBTRACT,
    TGL_FUNC_REVERSE_SUBTRACT,
    TGL_MIN,
    TGL_MAX,
    TGL_ONE_MINUS_SRC_ALPHA,
    TGL_ONE_MINUS_DST_ALPHA,
    TGL_ONE_MINUS_SRC_COLOR,
    TGL_ONE_MINUS_DST_COLOR,
    // etc.

    // Query / timer / sync / occlusion / transform feedback / buffer query
    TGL_QUERY_COUNTER_BITS,
    TGL_CURRENT_QUERY,
    TGL_QUERY_RESULT,
    TGL_QUERY_RESULT_AVAILABLE,
    TGL_SAMPLES_PASSED,
    TGL_PRIMITIVES_GENERATED,
    TGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN,
    TGL_TIME_ELAPSED,
    TGL_TIMESTAMP,
    // etc.

    // Misc / other
    TGL_VIEWPORT,
    TGL_SCISSOR_BOX,
    TGL_COLOR_CLEAR_VALUE,
    TGL_DEPTH_CLEAR_VALUE,
    TGL_STENCIL_CLEAR_VALUE,
    TGL_COLOR_WRITEMASK,
    TGL_DEPTH_WRITEMASK,
    TGL_STENCIL_WRITEMASK,
    TGL_STENCIL_BACK_WRITEMASK,
    TGL_MAX_VIEWPORT_DIMS,
    TGL_MAX_COMBINED_TEXTURE_IMAGE_UNITS,
    TGL_MAX_TEXTURE_IMAGE_UNITS,
    TGL_MAX_VERTEX_ATTRIBS,
    TGL_MAX_VERTEX_UNIFORM_COMPONENTS,
    TGL_MAX_FRAGMENT_UNIFORM_COMPONENTS,
    TGL_MAX_UNIFORM_BLOCK_SIZE,
    TGL_MAX_DRAW_BUFFERS,
    TGL_MAX_COLOR_ATTACHMENTS,
    TGL_MAX_ARRAY_TEXTURE_LAYERS,
    TGL_MAX_FRAMEBUFFER_WIDTH,
    TGL_MAX_FRAMEBUFFER_HEIGHT,
    TGL_MAX_FRAMEBUFFER_LAYERS,
    TGL_COLOR_BUFFER_BIT,
    TGL_DEPTH_BUFFER_BIT,
    TGL_STENCIL_BUFFER_BIT,

    // Debug / debug output (if KHR or core debug)
    TGL_DEBUG_OUTPUT,
    TGL_DEBUG_OUTPUT_SYNCHRONOUS,
    TGL_DEBUG_SOURCE_API,
    TGL_DEBUG_SOURCE_WINDOW_SYSTEM,
    TGL_DEBUG_SOURCE_SHADER_COMPILER,
    TGL_DEBUG_SOURCE_THIRD_PARTY,
    TGL_DEBUG_SOURCE_APPLICATION,
    TGL_DEBUG_SOURCE_OTHER,
    TGL_DEBUG_TYPE_ERROR,
    TGL_DEBUG_TYPE_DEPRECATED_BEHAVIOR,
    TGL_DEBUG_TYPE_UNDEFINED_BEHAVIOR,
    TGL_DEBUG_TYPE_PORTABILITY,
    TGL_DEBUG_TYPE_PERFORMANCE,
    TGL_DEBUG_TYPE_MARKER,
    TGL_DEBUG_TYPE_PUSH_GROUP,
    TGL_DEBUG_TYPE_POP_GROUP,
    TGL_DEBUG_TYPE_OTHER,
    TGL_DEBUG_SEVERITY_HIGH,
    TGL_DEBUG_SEVERITY_MEDIUM,
    TGL_DEBUG_SEVERITY_LOW,
    TGL_DEBUG_SEVERITY_NOTIFICATION,

    TGL_TEXTURE0,
    TGL_TEXTURE1,
    TGL_TEXTURE2,
    TGL_TEXTURE3,
    TGL_TEXTURE4,
    TGL_TEXTURE5,
    TGL_TEXTURE6,
    TGL_TEXTURE7,
    TGL_TEXTURE8,
    TGL_TEXTURE9,
    TGL_TEXTURE10,
    TGL_TEXTURE11,
    TGL_TEXTURE12,
    TGL_TEXTURE13,
    TGL_TEXTURE14,
    TGL_TEXTURE15,
    TGL_TEXTURE16,
    TGL_TEXTURE17,
    TGL_TEXTURE18,
    TGL_TEXTURE19,
    TGL_TEXTURE20,
    TGL_TEXTURE21,
    TGL_TEXTURE22,
    TGL_TEXTURE23,
    TGL_TEXTURE24,
    TGL_TEXTURE25,
    TGL_TEXTURE26,
    TGL_TEXTURE27,
    TGL_TEXTURE28,
    TGL_TEXTURE29,
    TGL_TEXTURE30,
    TGL_TEXTURE31,

};

enum class GLModuleFunction
{
    TGL_INIT,

    // Buffer Objects
    TGL_GEN_BUFFERS,
    TGL_DELETE_BUFFERS,
    TGL_BIND_BUFFER,
    TGL_BUFFER_DATA,
    TGL_BUFFER_SUB_DATA,
    TGL_MAP_BUFFER,
    TGL_UNMAP_BUFFER,

    // Vertex Arrays
    TGL_GEN_VERTEX_ARRAYS,
    TGL_DELETE_VERTEX_ARRAYS,
    TGL_BIND_VERTEX_ARRAY,
    TGL_ENABLE_VERTEX_ATTRIB_ARRAY,
    TGL_DISABLE_VERTEX_ATTRIB_ARRAY,
    TGL_VERTEX_ATTRIB_POINTER,
    TGL_VERTEX_ATTRIB_IPOINTER,
    TGL_VERTEX_ATTRIB_DIVISOR,
    TGL_BIND_VERTEX_BUFFER,
    TGL_VERTEX_ATTRIB_FORMAT,
    TGL_VERTEX_ATTRIB_BINDING,

    // Drawing Commands
    TGL_DRAW_ARRAYS,
    TGL_DRAW_ELEMENTS,
    TGL_DRAW_ELEMENTS_BASE_VERTEX,
    TGL_DRAW_ELEMENTS_INSTANCED,
    TGL_DRAW_ARRAYS_INSTANCED,
    TGL_DRAW_RANGE_ELEMENTS,
    TGL_DRAW_BUFFER,
    TGL_DRAW_BUFFERS,
    TGL_CLEAR,
    TGL_CLEAR_COLOR,
    TGL_CLEAR_DEPTH,
    TGL_CLEAR_STENCIL,
    TGL_POLYGON_MODE,
    TGL_LINE_WIDTH,
    TGL_POINT_SIZE,
    TGL_CULL_FACE,
    TGL_FRONT_FACE,
    TGL_POLYGON_OFFSET,
    TGL_SCISSOR,
    TGL_VIEWPORT,

    // Framebuffers / Renderbuffers
    TGL_GEN_FRAMEBUFFERS,
    TGL_DELETE_FRAMEBUFFERS,
    TGL_BIND_FRAMEBUFFER,
    TGL_FRAMEBUFFER_TEXTURE,
    TGL_FRAMEBUFFER_TEXTURE_2D,
    TGL_FRAMEBUFFER_TEXTURE_LAYER,
    TGL_FRAMEBUFFER_RENDERBUFFER,
    TGL_CHECK_FRAMEBUFFER_STATUS,
    TGL_GEN_RENDERBUFFERS,
    TGL_DELETE_RENDERBUFFERS,
    TGL_BIND_RENDERBUFFER,
    TGL_RENDERBUFFER_STORAGE,
    TGL_RENDERBUFFER_STORAGE_MULTISAMPLE,
    TGL_BLIT_FRAMEBUFFER,
    TGL_READ_BUFFER,
    TGL_READ_PIXELS,
    TGL_INVALIDATE_FRAMEBUFFER,
    TGL_INVALIDATE_SUB_FRAMEBUFFER,

    // Shaders and Programs
    TGL_CREATE_SHADER,
    TGL_SHADER_SOURCE,
    TGL_COMPILE_SHADER,
    TGL_DELETE_SHADER,
    TGL_CREATE_PROGRAM,
    TGL_ATTACH_SHADER,
    TGL_DETACH_SHADER,
    TGL_LINK_PROGRAM,
    TGL_VALIDATE_PROGRAM,
    TGL_DELETE_PROGRAM,
    TGL_USE_PROGRAM,
    TGL_GET_SHADERIV,
    TGL_GET_SHADER_INFO_LOG,
    TGL_GET_PROGRAMIV,
    TGL_GET_PROGRAM_INFO_LOG,
    TGL_GET_ACTIVE_UNIFORM,
    TGL_GET_ACTIVE_ATTRIBUTE,
    TGL_GET_UNIFORM_LOCATION,
    TGL_GET_ATTRIB_LOCATION,
    TGL_UNIFORM_1I,
    TGL_UNIFORM_1F,
    TGL_UNIFORM_2F,
    TGL_UNIFORM_3F,
    TGL_UNIFORM_4F,
    TGL_UNIFORM_MATRIX4FV,
    TGL_GET_UNIFORMFV,
    TGL_GET_UNIFORMIV,
    TGL_BIND_ATTRIB_LOCATION,
    TGL_GET_PROGRAM_BINARY,
    TGL_PROGRAM_BINARY,
    TGL_PROGRAM_PARAMETERI,
    TGL_GET_ACTIVE_UNIFORM_BLOCKIV,
    TGL_GET_UNIFORM_BLOCK_INDEX,
    TGL_UNIFORM_BLOCK_BINDING,
    TGL_DISPATCH_COMPUTE,
    TGL_DISPATCH_COMPUTE_INDIRECT,

    // Textures
    TGL_GEN_TEXTURES,
    TGL_DELETE_TEXTURES,
    TGL_BIND_TEXTURE,
    TGL_ACTIVE_TEXTURE,
    TGL_TEX_IMAGE_1D,
    TGL_TEX_IMAGE_2D,
    TGL_TEX_IMAGE_3D,
    TGL_TEX_SUB_IMAGE_1D,
    TGL_TEX_SUB_IMAGE_2D,
    TGL_TEX_SUB_IMAGE_3D,
    TGL_COMPRESSED_TEX_IMAGE_2D,
    TGL_COMPRESSED_TEX_SUB_IMAGE_2D,
    TGL_COPY_TEX_SUB_IMAGE_2D,
    TGL_TEX_PARAMETERI,
    TGL_TEX_PARAMETERF,
    TGL_TEX_PARAMETERIV,
    TGL_TEX_PARAMETERFV,
    TGL_GENERATE_MIPMAP,
    TGL_BIND_IMAGE_TEXTURE,
    TGL_TEX_STORAGE_1D,
    TGL_TEX_STORAGE_2D,
    TGL_TEX_STORAGE_3D,
    TGL_GET_TEX_IMAGE,
    TGL_GET_TEX_PARAMETERIV,
    TGL_GET_TEX_LEVEL_PARAMETERIV,

    // Uniform Buffer Objects
    TGL_GET_UNIFORM_INDICES,
    TGL_GET_ACTIVE_UNIFORMSIV,
    TGL_BIND_BUFFER_BASE,
    TGL_BIND_BUFFER_RANGE,
    TGL_GET_ACTIVE_UNIFORM_BLOCK_NAME,

    // Transform Feedback
    TGL_BEGIN_TRANSFORM_FEEDBACK,
    TGL_END_TRANSFORM_FEEDBACK,
    TGL_TRANSFORM_FEEDBACK_VARYINGS,
    TGL_BIND_TRANSFORM_FEEDBACK,
    TGL_PAUSE_TRANSFORM_FEEDBACK,
    TGL_RESUME_TRANSFORM_FEEDBACK,

    // Queries
    TGL_GEN_QUERIES,
    TGL_DELETE_QUERIES,
    TGL_BEGIN_QUERY,
    TGL_END_QUERY,
    TGL_GET_QUERY_OBJECTUIV,
    TGL_GET_QUERY_OBJECTI64V,
    TGL_GET_QUERY_OBJECTUI64V,
    TGL_QUERY_COUNTER,

    // Sync / Fences
    TGL_FENCE_SYNC,
    TGL_DELETE_SYNC,
    TGL_IS_SYNC,
    TGL_CLIENT_WAIT_SYNC,
    TGL_WAIT_SYNC,
    TGL_GET_SYNC_IV,

    // State Management
    TGL_ENABLE,
    TGL_DISABLE,
    TGL_IS_ENABLED,
    TGL_DEPTH_FUNC,
    TGL_BLEND_FUNC,
    TGL_BLEND_FUNC_SEPARATE,
    TGL_BLEND_EQUATION,
    TGL_BLEND_EQUATION_SEPARATE,
    TGL_DEPTH_MASK,
    TGL_COLOR_MASK,
    TGL_STENCIL_FUNC,
    TGL_STENCIL_FUNC_SEPARATE,
    TGL_STENCIL_MASK,
    TGL_STENCIL_MASK_SEPARATE,
    TGL_STENCIL_OP,
    TGL_STENCIL_OP_SEPARATE,

    // Sampler Objects
    TGL_GEN_SAMPLERS,
    TGL_DELETE_SAMPLERS,
    TGL_BIND_SAMPLER,
    TGL_SAMPLER_PARAMETERI,
    TGL_SAMPLER_PARAMETERF,
    TGL_SAMPLER_PARAMETERIV,
    TGL_SAMPLER_PARAMETERFV,

    // Program Pipelines
    TGL_GEN_PROGRAM_PIPELINES,
    TGL_DELETE_PROGRAM_PIPELINES,
    TGL_BIND_PROGRAM_PIPELINE,
    TGL_USE_PROGRAM_STAGES,
    TGL_ACTIVE_SHADER_PROGRAM,
    TGL_GET_PROGRAM_PIPELINEIV,
    TGL_GET_PROGRAM_PIPELINE_INFO_LOG,
    TGL_VALIDATE_PROGRAM_PIPELINE,

    // Compute Shaders
    TGL_MEMORY_BARRIER,
    TGL_TEXTURE_BARRIER,

    // Debug / Logging
    TGL_DEBUG_MESSAGE_CALLBACK,
    TGL_DEBUG_MESSAGE_CONTROL,
    TGL_PUSH_DEBUG_GROUP,
    TGL_POP_DEBUG_GROUP,
    TGL_OBJECT_LABEL,
    TGL_OBJECT_PTR_LABEL,
    TGL_GET_OBJECT_LABEL,
    TGL_GET_OBJECT_PTR_LABEL,

    // VAO / Buffer Introspection
    TGL_GET_VERTEX_ATTRIB_IV,
    TGL_GET_VERTEX_ATTRIB_POINTERV,
    TGL_GET_BUFFER_PARAMETERI64V,

    // MultiDraw / Indirect
    TGL_DRAW_ARRAYS_INDIRECT,
    TGL_DRAW_ELEMENTS_INDIRECT,
    TGL_MULTI_DRAW_ARRAYS,
    TGL_MULTI_DRAW_ELEMENTS,
    TGL_MULTI_DRAW_ARRAYS_INDIRECT,
    TGL_MULTI_DRAW_ELEMENTS_INDIRECT,

    // TODO: Advanced 4.6 features (Bindless textures, Sparse textures, ARB extensions)
    // TGL_MAKE_TEXTURE_HANDLE_RESIDENT_ARB
    // TGL_TEXTURE_STORAGE_SPARSE_ARB
    // etc.

    TGL_FUNCTION_COUNT
};

class Program;
class GLModule
{
public:
    static bool Init();
    static Value CallFunction(Program* program, uint16 function, const std::vector<Value>& args);
    static Value Constant(Program* program, uint16 constant);

    static TypeInfo GetFunctionReturnInfo(uint16 function);
    static TypeInfo GetConstantTypeInfo(uint16 constant);
};